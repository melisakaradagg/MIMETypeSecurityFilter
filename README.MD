# ğŸ›¡ï¸ MIMEType Content Security Filter

![Language](https://img.shields.io/badge/Language-Java%20%7C%20Python-blue?logo=secure)
![Security Standard](https://img.shields.io/badge/Security-NIST%20%7C%20OWASP-black)
![Category](https://img.shields.io/badge/Category-AppSec%20%7C%20Content%20Safety-orange)
![License](https://img.shields.io/badge/License-MIT-green)

**MIMETypeSecurityFilter**, web uygulamalarÄ±na yÃ¼klenen veya sunulan dosyalarÄ±n iÃ§erik tÃ¼rlerini (MIME) derinlemesine analiz eden, "Content Sniffing" saldÄ±rÄ±larÄ±nÄ± ve kÃ¶tÃ¼ niyetli dosya yÃ¼rÃ¼tme giriÅŸimlerini engelleyen geliÅŸmiÅŸ bir gÃ¼venlik filtresidir.

---

## ğŸ“‘ Ä°Ã§indekiler

- [Proje HakkÄ±nda](#-proje-hakkÄ±nda)
- [Temel GÃ¼venlik FonksiyonlarÄ±](#-temel-gÃ¼venlik-fonksiyonlarÄ±)
- [Teknik Metodoloji](#-teknik-metodoloji)
- [Kurulum ve Entegrasyon](#-kurulum-ve-entegrasyon)
- [Ã–rnek Senaryo](#-Ã¶rnek-senaryo)
- [Yasal UyarÄ±](#-yasal-uyarÄ±)

---

## Proje HakkÄ±nda

Modern web saldÄ±rÄ±larÄ±nda, saldÄ±rganlar genellikle dosya uzantÄ±larÄ±nÄ± manipÃ¼le ederek sistemlere sÄ±zmaya Ã§alÄ±ÅŸÄ±rlar (Ã–rn: `.jpg` gÃ¶rÃ¼nÃ¼mlÃ¼ bir `.php` shell dosyasÄ±). 

Bu filtre, sadece dosya uzantÄ±sÄ±na veya tarayÄ±cÄ±dan gelen `Content-Type` header bilgisine gÃ¼venmek yerine, dosyanÄ±n **binary (ikili) yapÄ±sÄ±nÄ±** inceleyerek gerÃ§ek kimliÄŸini doÄŸrular. Proje, kurumsal dÃ¼zeydeki uygulamalarda **Unrestricted File Upload** zafiyetini minimize etmek iÃ§in tasarlanmÄ±ÅŸtÄ±r.

---

## Temel GÃ¼venlik FonksiyonlarÄ±

Proje, dosya gÃ¼venliÄŸi Ã¼zerinde 3 ana katmanda koruma saÄŸlar:

### 1. Magic Bytes (Signature) DoÄŸrulamasÄ±
DosyanÄ±n ilk baytlarÄ±nÄ± analiz ederek gerÃ§ek tÃ¼rÃ¼nÃ¼ belirler.
- **Header EÅŸleÅŸmesi:** Gelen HTTP header bilgisi ile dosya imzasÄ±nÄ±n (Magic Numbers) tutarlÄ±lÄ±ÄŸÄ±nÄ± kontrol eder.
- **Sahtecilik Tespiti:** Resim dosyasÄ± gibi gÃ¶rÃ¼nÃ¼p iÃ§inde executable (Ã§alÄ±ÅŸtÄ±rÄ±labilir) kod barÄ±ndÄ±ran dosyalarÄ± anÄ±nda bloklar.



### 2. Content Sniffing KorumasÄ±
TarayÄ±cÄ±larÄ±n MIME tÃ¼rlerini tahmin etme (sniffing) Ã¶zelliÄŸini devre dÄ±ÅŸÄ± bÄ±rakÄ±r.
- **X-Content-Type-Options:** TÃ¼m yanÄ±tlara `nosniff` parametresini otomatik olarak enjekte eder.
- **MIME Confusion:** TarayÄ±cÄ±nÄ±n bir metin dosyasÄ±nÄ± script olarak yorumlamasÄ±ndan kaynaklanan XSS risklerini ortadan kaldÄ±rÄ±r.

### 3.UzantÄ± ve Metadata TemizliÄŸi
- **Whitelist KontrolÃ¼:** Sadece izin verilen gÃ¼venli uzantÄ±larÄ±n sisteme girmesine izin verir.
- **Null Byte Injection:** Dosya isimlerindeki `%00` (Null Byte) gibi bypass tekniklerini temizler.

---

## Teknik Metodoloji

Bu filtre, analizlerini gerÃ§ekleÅŸtirirken aÅŸaÄŸÄ±daki endÃ¼stri standartlarÄ±nÄ± referans alÄ±r:

| Teknik | AÃ§Ä±klama |
| :--- | :--- |
| **Deep Packet Inspection** | Dosya iÃ§eriÄŸinin byte bazlÄ± taranarak zararlÄ± patternlerin (desenlerin) bulunmasÄ±. |
| **OWASP File Upload** | OWASP'Ä±n dosya yÃ¼kleme gÃ¼venliÄŸi iÃ§in Ã¶nerdiÄŸi "MIME Validation" pratikleri. |
| **Entropy Check** | Dosya iÃ§indeki verinin rastgeleliÄŸini Ã¶lÃ§erek gizlenmiÅŸ (obfuscated) kod tespiti. |

---

## Kurulum

Projeyi mevcut middleware yapÄ±nÄ±za entegre etmek iÃ§in:

```bash
# Projeyi klonlayÄ±n
git clone [https://github.com/EfeSidal/MIMETypeSecurityFilter.git](https://github.com/EfeSidal/MIMETypeSecurityFilter.git)

# BaÄŸÄ±mlÄ±lÄ±klarÄ± kontrol edin
cd MIMETypeSecurityFilter
pip install -r requirements.txt

from security_filter import MIMETypeFilter

# Filtreyi tanÄ±mla
mimetype_filter = MIMETypeFilter(allowed_types=['image/jpeg', 'image/png', 'application/pdf'])

# YÃ¼klenen dosyayÄ± doÄŸrula
is_secure = mimetype_filter.validate(request.files['upload_file'])

Developed by <b>MelisaKaradaÄŸ</b> for Safer Content Delivery 

Ã–ÄŸrenci NumarasÄ±: 2420191031
